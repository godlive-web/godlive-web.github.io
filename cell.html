<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3Dæ™¶èƒç»“æ„å¯è§†åŒ–ï¼ˆå¯æ‹¼æ¥/æ‹†åˆ†ï¼‰</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: "Microsoft YaHei", sans-serif;
        }

        body {
            background: #0a0a1a;
            overflow: hidden;
            color: #fff;
        }

        .header {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            padding: 15px 25px;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(10px);
            z-index: 100;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header h1 {
            font-size: 22px;
            font-weight: 500;
            color: #e0e0ff;
        }

        .control-tip {
            position: fixed;
            top: 80px;
            left: 20px;
            background: rgba(20, 20, 40, 0.8);
            padding: 12px 18px;
            border-radius: 8px;
            border: 1px solid rgba(100, 100, 255, 0.3);
            z-index: 99;
        }

        .control-tip p {
            font-size: 14px;
            margin: 4px 0;
            color: #c0c8ff;
        }

        .button-group {
            position: fixed;
            top: 80px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 99;
        }

        .btn {
            padding: 10px 20px;
            background: rgba(100, 100, 255, 0.3);
            border: 1px solid rgba(100, 100, 255, 0.5);
            border-radius: 6px;
            color: #fff;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn:hover {
            background: rgba(100, 100, 255, 0.5);
        }

        .cell-info {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(10, 10, 25, 0.85);
            padding: 15px 25px;
            border-radius: 10px;
            border: 1px solid rgba(120, 120, 255, 0.2);
            display: flex;
            gap: 25px;
            z-index: 99;
        }

        .cell-item {
            text-align: center;
        }

        .cell-item h3 {
            font-size: 16px;
            margin-bottom: 5px;
            color: #ff4444;
        }

        .cell-item:nth-child(2) h3 {
            color: #44aaff;
        }

        .cell-item:nth-child(3) h3 {
            color: #44dd44;
        }

        .cell-item p {
            font-size: 12px;
            color: #bbb;
        }

        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
        }
    </style>
</head>

<body>
    <div class="header">
        <h1>3Dæ™¶èƒç»“æ„äº¤äº’å¼å¯è§†åŒ–ï¼ˆå¯æ‹¼æ¥/æ‹†åˆ†ï¼‰</h1>
    </div>

    <div class="control-tip">
        <p>ğŸ–±ï¸ å·¦é”®æ‹–æ‹½ï¼šæ—‹è½¬3Dæ¨¡å‹</p>
        <p>ğŸ–±ï¸ æ»šè½®æ»‘åŠ¨ï¼šæ”¾å¤§/ç¼©å°</p>
        <p>ğŸ“Œ ç‚¹å‡»å³ä¾§æŒ‰é’®åˆ‡æ¢æ¨¡å¼</p>
    </div>

    <div class="button-group">
        <button class="btn" id="combineBtn">æ‹¼æ¥æˆæ•´ä½“</button>
        <button class="btn" id="splitBtn">æ‹†å¼€å±•ç¤º</button>
    </div>

    <div class="cell-info">
        <div class="cell-item">
            <h3>ç®€å•ç«‹æ–¹</h3>
            <p>ä»…é¡¶è§’åŸå­<br>è´¡çŒ®ï¼š1/8</p>
        </div>
        <div class="cell-item">
            <h3>ä½“å¿ƒç«‹æ–¹</h3>
            <p>é¡¶è§’+ä½“å¿ƒ<br>ä½“å¿ƒï¼šå®Œå…¨å æœ‰</p>
        </div>
        <div class="cell-item">
            <h3>é¢å¿ƒç«‹æ–¹</h3>
            <p>é¡¶è§’+6é¢å¿ƒ<br>é¢å¿ƒï¼šè´¡çŒ®1/2</p>
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/",
            "tween": "https://unpkg.com/@tweenjs/tween.js@18.6.4/dist/tween.esm.js"
        }
    }
    </script>

    <script type="module">
        import * as THREE from 'three';
        import { OrbitControls } from 'three/addons/controls/OrbitControls.js';
        import * as TWEEN from 'tween';

        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setClearColor(0x0a0a1a, 1);
        document.body.appendChild(renderer.domElement);

        const controls = new OrbitControls(camera, renderer.domElement);
        controls.enableDamping = true;
        controls.dampingFactor = 0.08;
        camera.position.set(10, 6, 12);

        const dirLight = new THREE.DirectionalLight(0xffffff, 1.1);
        dirLight.position.set(8, 8, 8);
        scene.add(dirLight);
        scene.add(new THREE.AmbientLight(0x404060));

        const cellGroups = [];
        const cellSize = 2;

        function createCell(type, x, y, z) {
            const group = new THREE.Group();
            group.position.set(x, y, z);
            const half = cellSize / 2;

            const boxGeo = new THREE.BoxGeometry(cellSize, cellSize, cellSize);
            const boxEdges = new THREE.EdgesGeometry(boxGeo);
            const boxMat = new THREE.LineBasicMaterial({ color: 0xa0a0ff });
            const boxLine = new THREE.LineSegments(boxEdges, boxMat);
            group.add(boxLine);

            const corners = [
                [-half,-half,-half], [half,-half,-half], [half,half,-half], [-half,half,-half],
                [-half,-half,half], [half,-half,half], [half,half,half], [-half,half,half]
            ];
            corners.forEach(p => {
                const s = new THREE.SphereGeometry(0.12, 16, 16);
                const m = new THREE.MeshLambertMaterial({ color: 0xff3333 });
                const mesh = new THREE.Mesh(s, m);
                mesh.position.set(...p);
                group.add(mesh);
            });

            if (type === 'body') {
                const s = new THREE.SphereGeometry(0.16, 16, 16);
                const m = new THREE.MeshLambertMaterial({ color: 0x33aaff });
                group.add(new THREE.Mesh(s, m));
            }

            if (type === 'face') {
                const faces = [[half,0,0], [-half,0,0], [0,half,0], [0,-half,0], [0,0,half], [0,0,-half]];
                faces.forEach(p => {
                    const s = new THREE.SphereGeometry(0.13, 16, 16);
                    const m = new THREE.MeshLambertMaterial({ color: 0x33dd33 });
                    const mesh = new THREE.Mesh(s, m);
                    mesh.position.set(...p);
                    group.add(mesh);
                });
            }

            scene.add(group);
            cellGroups.push(group);
            return group;
        }

        // åˆ›å»º2x2x2çš„æ™¶èƒé˜µåˆ—
        function createGrid() {
            for (let x = -1; x <= 1; x += 2) {
                for (let y = -1; y <= 1; y += 2) {
                    for (let z = -1; z <= 1; z += 2) {
                        createCell('face', x * cellSize, y * cellSize, z * cellSize);
                    }
                }
            }
        }

        function combine() {
            cellGroups.forEach((group, index) => {
                const x = (index % 2 - 0.5) * 2;
                const y = (Math.floor(index / 4) % 2 - 0.5) * 2;
                const z = (Math.floor(index / 2) % 2 - 0.5) * 2;
                
                new TWEEN.Tween(group.position)
                    .to({ x: x * cellSize, y: y * cellSize, z: z * cellSize }, 1000)
                    .easing(TWEEN.Easing.Quadratic.Out)
                    .start();
            });
        }

        function split() {
            cellGroups.forEach((group, index) => {
                const x = (index % 2 - 0.5) * 6;
                const y = (Math.floor(index / 4) % 2 - 0.5) * 6;
                const z = (Math.floor(index / 2) % 2 - 0.5) * 6;
                
                new TWEEN.Tween(group.position)
                    .to({ x: x, y: y, z: z }, 1000)
                    .easing(TWEEN.Easing.Quadratic.Out)
                    .start();
            });
        }

        createGrid();

        document.getElementById('combineBtn').addEventListener('click', combine);
        document.getElementById('splitBtn').addEventListener('click', split);

        function animate() {
            requestAnimationFrame(animate);
            TWEEN.update();
            controls.update();
            renderer.render(scene, camera);
        }
        animate();

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });
    </script>
</body>
</html>
