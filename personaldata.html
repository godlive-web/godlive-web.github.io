<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>ç¥ç•Œé˜ï¼ä¸ªäººä¿¡æ¯</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      -webkit-tap-highlight-color: transparent;
    }
    :root {
      /* æµ…è‰²ä¸»é¢˜å˜é‡ */
      --bg-primary: #f8f9fa;
      --bg-secondary: #ffffff;
      --text-primary: #212529;
      --text-secondary: #495057;
      --accent-color: #6f42c1;
      --accent-light: #e0d6ff;
      --border-color: #dee2e6;
      --shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
      --card-bg: #ffffff;
      --header-bg: rgba(255, 255, 255, 0.95);
      --sidebar-bg: rgba(248, 249, 250, 0.9);
      --content-bg: rgba(255, 255, 255, 1); /* å®Œå…¨ä¸é€æ˜ */
      --sidebar-width: 260px;
    }
    @media (prefers-color-scheme: dark) {
      :root {
        /* æ·±è‰²ä¸»é¢˜å˜é‡ */
        --bg-primary: #0c0c1e;
        --bg-secondary: #1a1a3a;
        --text-primary: #e0e0ff;
        --text-secondary: #a0a0ff;
        --accent-color: #8a63d2;
        --accent-light: rgba(100, 80, 255, 0.2);
        --border-color: rgba(100, 80, 255, 0.3);
        --shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        --card-bg: rgba(20, 20, 45, 1); /* å®Œå…¨ä¸é€æ˜ */
        --header-bg: rgba(15, 15, 35, 0.95);
        --sidebar-bg: rgba(20, 20, 45, 0.8);
        --content-bg: rgba(15, 15, 30, 1); /* å®Œå…¨ä¸é€æ˜ */
      }
    }
    body {
      font-family: "Microsoft YaHei", sans-serif;
      overflow: hidden;
      background: linear-gradient(135deg, var(--bg-primary) 0%, var(--bg-secondary) 100%);
      color: var(--text-primary);
      transition: background 0.3s ease, color 0.3s ease;
    }

    /* é¡¶éƒ¨å¯¼èˆª */
    .header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 70px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0 25px;
      background: var(--header-bg);
      box-shadow: var(--shadow);
      backdrop-filter: blur(10px);
      z-index: 999;
      border-bottom: 1px solid var(--border-color);
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .logo {
      height: 45px;
      width: auto;
    }
    .logo-link {
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .site-title {
      position: relative;
      font-size: 24px;
      font-weight: bold;
      color: var(--text-primary);
      text-shadow: 0 0 10px rgba(111, 66, 193, 0.3);
    }
    .web-badge {
      position: absolute;
      top: -8px;
      left: -20px;
      font-size: 10px;
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      padding: 2px 6px;
      border-radius: 4px;
      transform: rotate(-15deg);
      color: white;
    }
    .header-right {
      font-size: 16px;
      color: var(--text-secondary);
      font-weight: bold;
    }

    /* æ±‰å ¡èœå•æŒ‰é’® (ç§»åŠ¨ç«¯) */
    .hamburger-menu {
      display: none;
      flex-direction: column;
      justify-content: space-around;
      width: 30px;
      height: 25px;
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0;
      z-index: 1000;
    }
    .hamburger-menu span {
      width: 100%;
      height: 3px;
      background: var(--text-primary);
      border-radius: 2px;
      transition: all 0.3s ease;
    }
    .hamburger-menu.active span:nth-child(1) {
      transform: rotate(45deg) translate(5px, 5px);
    }
    .hamburger-menu.active span:nth-child(2) {
      opacity: 0;
    }
    .hamburger-menu.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -6px);
    }

    /* ä¸»å®¹å™¨ */
    .main-container {
      display: flex;
      margin-top: 70px;
      height: calc(100vh - 70px);
    }

    /* å·¦ä¾§å¯¼èˆªæ  */
    .sidebar {
      width: var(--sidebar-width);
      background: var(--sidebar-bg);
      border-right: 1px solid var(--border-color);
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
      display: flex;
      flex-direction: column;
      position: relative;
      padding-bottom: 70px;
      transition: transform 0.3s ease, width 0.3s ease;
      z-index: 998;
    }
    .sidebar-nav {
      padding: 15px 0;
      flex: 1;
    }
    .sidebar-item {
      border-bottom: 1px solid var(--border-color);
    }
    .sidebar-link {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 25px;
      width: 100%;
      font-size: 16px;
      background: none;
      border: none;
      cursor: pointer;
      color: var(--text-secondary);
      transition: all 0.3s ease;
      position: relative;
    }
    /* é¼ æ ‡æ‚¬åœåŠ¨ç”» */
    .sidebar-link:hover {
      background: var(--accent-light);
      color: var(--text-primary);
      transform: translateX(6px);
      box-shadow: 0 2px 8px rgba(111, 66, 193, 0.15);
    }
    .sidebar-link.active {
      background: var(--accent-light);
      color: var(--accent-color);
      transform: translateX(6px);
      box-shadow: 0 2px 8px rgba(111, 66, 193, 0.2);
    }
    .sidebar-link.active::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      height: 100%;
      width: 4px;
      background: linear-gradient(to bottom, #6a11cb, #2575fc);
    }
    .arrow {
      font-size: 12px;
      transition: transform 0.3s ease;
      color: var(--accent-color);
    }
    .sidebar-item.expanded .arrow {
      transform: rotate(180deg);
    }
    .function-intro {
      max-height: 0;
      overflow: hidden;
      padding: 0 25px;
      background: var(--card-bg);
      font-size: 13px;
      color: var(--text-secondary);
      transition: max-height 0.3s ease-out;
    }
    .sidebar-item.expanded .function-intro {
      max-height: 100px;
      padding: 10px 25px 14px;
    }

    /* å³ä¾§å†…å®¹åŒºï¼ˆæ¢å¤æ»‘åŠ¨æ•ˆæœï¼‰ */
    .content {
      flex: 1;
      position: relative;
      overflow: hidden; /* ä¸»å†…å®¹åŒºéšè—æº¢å‡ºï¼Œç¡®ä¿æ»‘åŠ¨æ•ˆæœæ­£å¸¸ */
      background: var(--content-bg);
      transition: margin-left 0.3s ease;
    }
    .content-section {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%; /* å†…å®¹åŒºé«˜åº¦å æ»¡è§†å£ */
      padding: 35px 30px;
      transition: transform 0.8s cubic-bezier(0.25, 0.8, 0.25, 1); /* é˜»å°¼æ„Ÿè¿‡æ¸¡ */
      color: var(--text-primary);
      overflow: hidden; /* å†…å®¹åŒºè‡ªèº«ä¸æ»šåŠ¨ï¼Œç”±æ•´ä½“æ»‘åŠ¨æ§åˆ¶ */
    }
    /* åˆå§‹å †å ä½ç½® */
    .content-section:nth-child(1) { transform: translateY(0); }
    .content-section:nth-child(2) { transform: translateY(100vh); }
    .content-section:nth-child(3) { transform: translateY(200vh); }

    .content-section h2 {
      font-size: 30px;
      margin-bottom: 18px;
      color: var(--text-primary);
      text-shadow: 0 0 10px rgba(111, 66, 193, 0.2);
      position: relative;
      padding-bottom: 12px;
    }
    .content-section h2::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      width: 60px;
      height: 3px;
      background: linear-gradient(to right, #6a11cb, #2575fc);
      border-radius: 3px;
    }
    .content-section .section-desc {
      color: var(--text-secondary);
      margin-bottom: 25px;
      font-style: italic;
      font-size: 15px;
    }
    .logout-link {
      color: var(--accent-color);
      cursor: pointer;
      text-decoration: underline;
      transition: all 0.3s ease;
    }
    .logout-link:hover {
      color: #6a11cb;
      text-shadow: 0 0 5px rgba(106, 17, 203, 0.3);
    }

    /* åŸºç¡€ä¿¡æ¯æ ·å¼ï¼ˆç¦ç”¨è¡¨æ ¼è‡ªèº«æ»‘åŠ¨å¹²æ‰°ï¼‰ */
    .info-card {
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 22px;
      margin-bottom: 25px;
      border: 1px solid var(--border-color);
      max-height: calc(100% - 120px); /* é™åˆ¶è¡¨æ ¼é«˜åº¦ */
      overflow-y: auto; /* è¡¨æ ¼å†…éƒ¨å¯æ»šåŠ¨ï¼Œä¸å½±å“é¡µé¢æ»‘åŠ¨ */
      overflow-x: hidden; /* ç¦ç”¨æ°´å¹³æ»‘åŠ¨ */
    }
    .info-item {
      display: flex;
      margin-bottom: 15px;
      padding-bottom: 15px;
      border-bottom: 1px dashed var(--border-color);
    }
    .info-item:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }
    .info-label {
      width: 110px;
      flex-shrink: 0;
      font-weight: bold;
      color: var(--text-primary);
      font-size: 15px;
    }
    .info-value {
      flex: 1;
      color: var(--text-secondary);
      word-break: break-word;
      font-size: 15px;
      line-height: 1.6;
    }
    .info-loading, .info-empty, .info-error {
      color: var(--text-secondary);
      padding: 20px 0;
      text-align: center;
    }

    /* è®¤è¯ä¿¡æ¯æ ·å¼ */
    .auth-placeholder {
      display: flex;
      justify-content: center;
      align-items: center;
      height: 60%;
      text-align: center;
      padding: 20px;
    }
    .auth-message {
      font-size: 18px;
      color: var(--text-secondary);
      max-width: 600px;
      padding: 25px;
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      border: 1px solid var(--border-color);
    }

    /* åé¦ˆé—®é¢˜æ ·å¼ */
    .feedback-form {
      background: var(--card-bg);
      border-radius: 12px;
      box-shadow: var(--shadow);
      padding: 22px;
      border: 1px solid var(--border-color);
      max-width: 800px;
      max-height: calc(100% - 120px);
      overflow-y: auto;
    }
    .form-group {
      margin-bottom: 18px;
    }
    .form-label {
      display: block;
      margin-bottom: 6px;
      font-weight: bold;
      color: var(--text-primary);
      font-size: 15px;
    }
    .form-control {
      width: 100%;
      padding: 10px 14px;
      background: var(--bg-secondary);
      border: 1px solid var(--border-color);
      border-radius: 8px;
      font-size: 15px;
      color: var(--text-primary);
      transition: all 0.3s ease;
    }
    .form-control:focus {
      outline: none;
      border-color: var(--accent-color);
      box-shadow: 0 0 0 3px var(--accent-light);
    }
    textarea.form-control {
      min-height: 90px;
      resize: vertical;
    }
    .btn-group {
      display: flex;
      gap: 12px;
      margin-top: 25px;
    }
    .btn {
      padding: 10px 22px;
      border-radius: 8px;
      font-size: 15px;
      font-weight: bold;
      cursor: pointer;
      transition: all 0.3s ease;
      border: none;
    }
    .btn-primary {
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      color: white;
      box-shadow: 0 4px 15px rgba(37, 117, 252, 0.3);
    }
    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(37, 117, 252, 0.5);
    }
    .btn-secondary {
      background: var(--bg-secondary);
      color: var(--text-primary);
      border: 1px solid var(--border-color);
    }
    .btn-secondary:hover {
      background: var(--accent-light);
    }
    .feedback-note {
      margin-top: 18px;
      padding: 12px 15px;
      background: var(--accent-light);
      border-radius: 8px;
      color: var(--accent-color);
      font-size: 13px;
      line-height: 1.6;
      max-height: 120px;
      overflow-y: auto;
    }

    /* ç§»åŠ¨ç«¯æ ·å¼ */
    @media (max-width: 768px) {
      .header {
        padding: 0 15px;
      }
      
      .hamburger-menu {
        display: flex;
        margin-right: 15px;
      }
      
      .sidebar {
        position: fixed;
        top: 70px;
        left: 0;
        height: calc(100vh - 70px);
        transform: translateX(-100%);
        width: 80%;
        max-width: 300px;
        z-index: 997;
        padding-bottom: 80px;
      }
      
      .sidebar.active {
        transform: translateX(0);
      }
      
      .sidebar-link {
        padding: 14px 20px;
        font-size: 15px;
      }
      
      .function-intro {
        padding: 0 20px;
        font-size: 12px;
      }
      
      .sidebar-item.expanded .function-intro {
        padding: 8px 20px 12px;
      }
      
      .content {
        margin-left: 0 !important;
      }
      
      .content-section {
        padding: 25px 15px;
      }
      
      .content-section h2 {
        font-size: 24px;
      }
      
      .info-item {
        flex-direction: column;
      }
      .info-label {
        width: 100%;
        margin-bottom: 5px;
      }
      
      .auth-message {
        font-size: 15px;
        padding: 18px;
      }
      
      .btn-group {
        flex-direction: column;
      }
      .btn {
        width: 100%;
      }
    }

    /* å°å±å¹•æ‰‹æœºæ ·å¼ */
    @media (max-width: 480px) {
      .sidebar {
        width: 85%;
      }
      
      .sidebar-link {
        padding: 12px 15px;
        font-size: 14px;
      }
      
      .arrow {
        margin-left: 5px;
      }
      
      .header-left {
        gap: 10px;
      }
      
      .site-title {
        font-size: 20px;
      }
    }
  </style>
</head>
<body>
  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <header class="header">
    <div class="header-left">
      <button class="hamburger-menu" id="hamburgerMenu">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <!-- ä¸»é¡µé¢è·³è½¬é“¾æ¥ -->
      <a href="https://godlive-web.github.io" class="logo-link">
        <img src="https://raw.githubusercontent.com/godlive-web/godlive-web.github.io/refs/heads/file/%E7%A5%9E%E7%95%8C%E5%AE%98%E7%BD%91icon_20240814_181538_0000.png" alt="ç¥ç•Œé˜Logo" class="logo">
        <div class="site-title">
          <span class="web-badge">Webç«¯</span>
          ç¥ç•Œé˜
        </div>
      </a>
    </div>
    <div class="header-right">ä¸ªäººä¿¡æ¯</div>
  </header>
  <!-- ä¸»å®¹å™¨ -->
  <div class="main-container">
    <!-- å·¦ä¾§å¯¼èˆª -->
    <aside class="sidebar" id="sidebar">
      <nav class="sidebar-nav">
        <div class="sidebar-item" data-index="0">
          <button class="sidebar-link active">
            ä¸ªäººä¿¡æ¯
            <span class="arrow">â–¼</span>
          </button>
          <div class="function-intro">
            å±•ç¤ºæ‚¨è®¾ç½®çš„ä¸ªäººä¿¡æ¯ï¼Œæ–°ç‰ˆæœ¬å·²æ”¯æŒæ‚¨ç›´æ¥ä¿®æ”¹ä¸ªäººä¿¡æ¯ã€‚
          </div>
        </div>

        <div class="sidebar-item" data-index="1">
          <button class="sidebar-link">
            è®¤è¯ä¿¡æ¯
            <span class="arrow">â–¼</span>
          </button>
          <div class="function-intro">
            å±•ç¤ºæ‚¨åœ¨ç¥ç•Œé˜/ç§‹é£Autingå®˜ç½‘çš„è®¤è¯ä¿¡æ¯ï¼Œç›®å‰è¯¥æ•°æ®åº“å°šåœ¨æ­å»º
          </div>
        </div>

        <div class="sidebar-item" data-index="2">
          <button class="sidebar-link">
            åé¦ˆé—®é¢˜
            <span class="arrow">â–¼</span>
          </button>
          <div class="function-intro">
            åé¦ˆæ‚¨ä¸ªäººä¿¡æ¯å­˜åœ¨çš„é—®é¢˜
          </div>
        </div>
      </nav>
    </aside>

    <!-- å³ä¾§å†…å®¹åŒº -->
    <main class="content">
      <!-- åŸºç¡€ä¿¡æ¯åŒº -->
      <section class="content-section" data-index="0">
        <h2>ä¸ªäººä¿¡æ¯</h2>
        <p class="section-desc" id="welcomeMessage">
          æ¬¢è¿æ‚¨ï¼ŒåŠ è½½ä¸­...ã€‚è¿™é‡Œå±•ç¤ºæ‚¨çš„ä¸ªäººä¿¡æ¯ï¼Œå¦‚éœ€ä¿®æ”¹ï¼Œè¯·ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ã€‚å¦‚éœ€é€€å‡ºç™»å½•ï¼Œè¯·ç‚¹å‡»<span class="logout-link" id="logoutLink">æ³¨é”€</span>
        </p>
        
        <div class="info-card" id="basicInfoCard">
          <!-- ä¿¡æ¯å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
          <div class="info-loading">æ­£åœ¨åŠ è½½æ‚¨çš„ä¸ªäººä¿¡æ¯...</div>
        </div>
        <!-- æ–°å¢ç¼–è¾‘æŒ‰é’® -->
        <div style="margin-top: 20px;">
          <button id="editInfoBtn" class="btn btn-primary">ç¼–è¾‘ä¸ªäººä¿¡æ¯</button>
        </div>
      </section>

      <!-- è®¤è¯ä¿¡æ¯åŒº -->
      <section class="content-section" data-index="1">
        <h2>è®¤è¯ä¿¡æ¯</h2>
        <p class="section-desc">æŸ¥çœ‹æ‚¨çš„ç¥ç•Œé˜å®˜æ–¹è®¤è¯æˆå°±ä¸ä¸“å±é“­ç‰Œ</p>
        
        <!-- ç¬¬ä¸€å±‚ï¼šå¤§åˆ†ç±»å±•ç¤º -->
        <div class="info-card" id="categoryCard" style="max-height: none;">
          <div id="categoryList" style="display: flex; flex-wrap: wrap; gap: 15px;"></div>
        </div>
      </section>

      <!-- åé¦ˆé—®é¢˜åŒº -->
      <section class="content-section" data-index="2">
        <h2>åé¦ˆé—®é¢˜</h2>
        <p class="section-desc">åé¦ˆæ‚¨ä¸ªäººä¿¡æ¯å­˜åœ¨çš„é—®é¢˜</p>
        
        <div class="feedback-form">
          <div class="form-group">
            <label for="problemField" class="form-label">å­˜åœ¨é—®é¢˜çš„æ•°æ®é¡¹ <span style="color: #dc3545;">*</span></label>
            <input type="text" id="problemField" class="form-control" placeholder="ä¾‹å¦‚ï¼šè‡ªè®¾åç§°ã€å‡ºç”Ÿæ—¥æœŸç­‰" required>
          </div>
          
          <div class="form-group">
            <label for="expectedValue" class="form-label">å¸Œæœ›çš„æ•°æ®ï¼ˆé€‰å¡«ï¼‰</label>
            <textarea id="expectedValue" class="form-control" placeholder="è¯·è¾“å…¥æ‚¨å¸Œæœ›ä¿®æ”¹åçš„æ•°æ®"></textarea>
          </div>
          
          <div class="feedback-note">
            æäº¤åå°†è½¬è·³è‡³QQç§‹é£çš„ä¸ªäººè´¦å·èŠå¤©æ¡†ï¼Œè¯·å°†å‰ªåˆ‡æ¿ä¸­çš„å†…å®¹ç²˜è´´åå‘é€ç»™ç§‹é£ã€‚è‹¥æœªè·³è½¬ï¼Œè¯·æ‰‹åŠ¨æ‰“å¼€QQã€‚
          </div>
          
          <div class="btn-group">
            <button type="button" class="btn btn-primary" id="submitFeedback">ç¡®è®¤æäº¤</button>
            <button type="button" class="btn btn-secondary" id="cancelFeedback">å–æ¶ˆ</button>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- ç¬¬äºŒå±‚ï¼šåˆ†ç±»è¯¦æƒ…å¼¹çª— -->
  <div id="categoryModalOverlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9998; display: none; opacity: 0; transition: opacity 0.3s ease;"></div>
  <div id="categoryModal" style="position: fixed; bottom: 0; left: 0; width: 100%; height: 80vh; background: var(--content-bg); z-index: 9999; transform: translateY(100%); transition: transform 0.4s cubic-bezier(0.25, 0.8, 0.25, 1); border-top-left-radius: 16px; border-top-right-radius: 16px; overflow: hidden;">
    <!-- ç”µè„‘ç«¯é€‚é…ï¼šä¸é®ç›–å·¦ä¾§æ±‰å ¡èœå• -->
    <div id="categoryModalContent" style="width: 100%; height: 100%; padding: 20px; overflow-y: auto; -webkit-overflow-scrolling: touch;">
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid var(--border-color);">
        <h3 id="categoryModalTitle" style="font-size: 20px; color: var(--text-primary); margin: 0;">åˆ†ç±»åç§°</h3>
        <button id="closeCategoryModalBtn" style="background: none; border: none; font-size: 24px; color: var(--text-secondary); cursor: pointer; transition: all 0.2s ease; padding: 0; width: 36px; height: 36px; display: flex; justify-content: center; align-items: center; border-radius: 50%;">Ã—</button>
      </div>
      <div id="badgeListInModal" style="display: flex; flex-wrap: wrap; gap: 15px;"></div>
      <div id="badgeEmptyInModal" class="info-empty" style="display: none; padding: 40px 0;">æ‚¨è¿˜æ²¡æœ‰è¯¥åˆ†ç±»ä¸‹çš„é“­ç‰Œ</div>
    </div>
  </div>

  <!-- ç¬¬ä¸‰å±‚ï¼šå•ä¸ªé“­ç‰Œè¯¦æƒ…å¼¹çª— -->
  <div id="badgeModalOverlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 10000; display: none; opacity: 0; transition: opacity 0.3s ease;"></div>
  <div id="badgeModal" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%) scale(0.8); background: var(--card-bg); border-radius: 12px; box-shadow: var(--shadow); border: 1px solid var(--border-color); max-width: 90%; width: 500px; max-height: 80vh; overflow: hidden; z-index: 10001; opacity: 0; transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);">
    <div style="display: flex; justify-content: space-between; align-items: center; padding: 15px 20px; border-bottom: 1px solid var(--border-color);">
      <h3 id="badgeModalTitle" style="font-size: 18px; color: var(--text-primary); margin: 0;">é“­ç‰Œåç§°</h3>
      <button id="closeBadgeModalBtn" style="background: none; border: none; font-size: 22px; color: var(--text-secondary); cursor: pointer; transition: all 0.2s ease; padding: 0; width: 32px; height: 32px; display: flex; justify-content: center; align-items: center; border-radius: 50%;">Ã—</button>
    </div>
    <div style="padding: 20px; text-align: center; overflow-y: auto; max-height: calc(80vh - 60px);">
      <img id="badgeModalImg" src="" alt="é“­ç‰Œ" style="max-width: 100%; border-radius: 8px; margin-bottom: 15px;">
      <div id="badgeModalTime" style="font-size: 14px; color: var(--text-secondary); margin-bottom: 10px;">è·å¾—æ—¶é—´ï¼šâ€”â€”</div>
      <div id="badgeModalDesc" style="font-size: 15px; color: var(--text-primary); line-height: 1.6; text-align: left;">â€”â€”</div>
    </div>
  </div>

  <script>
    // å…¨å±€å˜é‡ï¼šä¿å­˜æœ€æ–°çš„ç”¨æˆ·æ•°æ®ï¼Œç»•è¿‡Cookieç¼“å­˜é—®é¢˜
    let globalLatestUserData = null;
    // VercelåŸŸåé…ç½®
    const VERCEL_DOMAIN = "https://godlive-web-github-io.vercel.app";

    // Cookieå¤„ç†å‡½æ•°
    function setCookie(name, value, days, sameSite = 'Lax') {
      const expires = new Date();
      expires.setTime(expires.getTime() + days * 24 * 60 * 60 * 1000);
      document.cookie = `${name}=${encodeURIComponent(value)};expires=${expires.toUTCString()};path=/;SameSite=None;Secure`;
    }

    // è¯»å–Cookieå‡½æ•°
    function getCookie(name) {
      const nameEQ = name + "=";
      const ca = document.cookie.split(';');
      for(let i = 0; i < ca.length; i++) {
        let c = ca[i].trim();
        if (c.indexOf(nameEQ) === 0) {
          return decodeURIComponent(c.substring(nameEQ.length));
        }
      }
      return null;
    }

    // æ˜¾ç¤ºæ¶ˆæ¯æç¤º
    function showMessage(text, type) {
      const messageElement = document.getElementById('message');
      if (messageElement) {
        messageElement.textContent = text;
        messageElement.className = type;
      }
    }

    // ã€ä¿®å¤ã€‘æ³¨é”€åŠŸèƒ½ï¼šæ¸…ç©ºæ‰€æœ‰æ•°æ®å’Œå…¨å±€å˜é‡
    function setupLogoutFunction() {
      const logoutLink = document.getElementById('logoutLink');
      if (logoutLink) {
        logoutLink.addEventListener('click', function() {
          if (confirm('ç¡®å®šè¦æ³¨é”€è´¦å·å—ï¼Ÿæ³¨é”€åå°†è¿”å›ç™»å½•é¡µ')) {
            // æ¸…ç©ºCookie
            setCookie('userData', '', -1);
            setCookie('user', '', -1);
            // æ¸…ç©ºå…¨å±€å˜é‡
            globalLatestUserData = null;
            // è·³è½¬åˆ°ç™»å½•é¡µ
            window.location.href = 'https://godlive-web.github.io/login.html';
          }
        });
      }
    }

    // æ£€æŸ¥ç™»å½•çŠ¶æ€
    function checkLoginStatus() {
      const userCookie = getCookie('user');
      const userDataStr = getCookie('userData');
      if (!userCookie || userCookie === '' || !userDataStr) {
        window.location.href = 'https://godlive-web.github.io/login.html';
        return false;
      }
      // æ ¡éªŒCookieé‡Œçš„ç”¨æˆ·æ•°æ®æ ¼å¼
      try {
        JSON.parse(userDataStr);
      } catch (e) {
        setCookie('userData', '', -1);
        setCookie('user', '', -1);
        window.location.href = 'https://godlive-web.github.io/login.html';
        return false;
      }
      return true;
    }

    // ä»åç«¯æ¥å£è·å–æœ€æ–°ç”¨æˆ·ä¿¡æ¯
    async function fetchLatestUserInfo() {
      const userID = getCookie('user');
      if (!userID) {
        showMessage('æœªæ£€æµ‹åˆ°ç™»å½•çŠ¶æ€ï¼Œè¯·é‡æ–°ç™»å½•', 'error');
        // å…œåº•ï¼šä»Cookieè¯»å–
        const userDataStr = getCookie('userData');
        if (userDataStr) {
          try {
            return JSON.parse(userDataStr);
          } catch (e) {
            return null;
          }
        }
        return null;
      }

      try {
        const response = await fetch(`${VERCEL_DOMAIN}/api/getUserInfo?userid=${userID}`, {
          method: 'GET',
          mode: 'cors'
        });
        if (!response.ok) throw new Error('æ¥å£è¯·æ±‚å¤±è´¥');
        const result = await response.json();
        if (result.success) {
          console.log('âœ… æ¥å£è¿”å›çš„æœ€æ–°ç”¨æˆ·æ•°æ®ï¼š', result.data);
          // æ›´æ–°å…¨å±€å˜é‡å’ŒCookie
          globalLatestUserData = result.data;
          setCookie('userData', JSON.stringify(result.data), 7);
          return result.data;
        } else {
          showMessage(result.msg, 'error');
          const userDataStr = getCookie('userData');
          if (userDataStr) return JSON.parse(userDataStr);
          return null;
        }
      } catch (error) {
        console.error('è·å–æœ€æ–°ç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
        const userDataStr = getCookie('userData');
        if (userDataStr) {
          try {
            const data = JSON.parse(userDataStr);
            globalLatestUserData = data;
            return data;
          } catch (e) {
            return null;
          }
        }
        showMessage('ç½‘ç»œé”™è¯¯ï¼Œå·²åŠ è½½æœ¬åœ°ç¼“å­˜æ•°æ®', 'error');
        return null;
      }
    }

    // åŠ è½½å¹¶æ˜¾ç¤ºåŸºç¡€ä¿¡æ¯
    function loadBasicInfo(userData) {
      const infoCard = document.getElementById('basicInfoCard');
      const welcomeMessage = document.getElementById('welcomeMessage');
      
      if (!userData) {
        infoCard.innerHTML = '<div class="info-error">æœªè·å–åˆ°ç”¨æˆ·ä¿¡æ¯ï¼Œè¯·é‡æ–°ç™»å½•</div>';
        return;
      }
      
      const userName = userData['è´¦å·åç§°'] || userData['è‡ªè®¾åç§°'] || 'ç”¨æˆ·';
      if (welcomeMessage) {
        welcomeMessage.innerHTML = `æ¬¢è¿æ‚¨ï¼Œ${userName}ã€‚è¿™é‡Œå±•ç¤ºæ‚¨çš„ä¸ªäººä¿¡æ¯ï¼Œå¦‚éœ€ä¿®æ”¹ï¼Œè¯·ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ã€‚å¦‚éœ€é€€å‡ºç™»å½•ï¼Œè¯·ç‚¹å‡»<span class="logout-link" id="logoutLink">æ³¨é”€</span>`;
      }
      setupLogoutFunction();
      
      setTimeout(() => {
        try {
          let infoHtml = '';
          const fields = [
            { key: 'user', label: 'ID' },
            { key: 'è´¦å·åç§°', label: 'è´¦å·åç§°' },
            { key: 'è‡ªè®¾åç§°', label: 'è‡ªè®¾åç§°' },
            { key: 'å…¥åœˆæ—¶é—´', label: 'å…¥åœˆæ—¶é—´' },
            { key: 'æ¨¡ç³Šä½å€', label: 'æ¨¡ç³Šä½å€' },
            { key: 'å‡ºç”Ÿæ—¥æœŸ', label: 'å‡ºç”Ÿæ—¥æœŸ' },
            { key: 'ä¸ªäººä»‹ç»', label: 'ä¸ªäººä»‹ç»' },
            { key: 'è´¦å·çŠ¶æ€', label: 'è´¦å·çŠ¶æ€' }
          ];
          
          fields.forEach(field => {
            let value = userData[field.key] || 'æœªå¡«å†™';
            if (field.key === 'è´¦å·çŠ¶æ€') {
              value = Number(value) === 0 ? 'æ­£å¸¸' : value;
            }
            infoHtml += `
              <div class="info-item">
                <div class="info-label">${field.label}</div>
                <div class="info-value">${value}</div>
              </div>
            `;
          });
          if (infoCard) {
            infoCard.innerHTML = infoHtml;
          }
        } catch (error) {
          console.error('è§£æç”¨æˆ·ä¿¡æ¯å¤±è´¥:', error);
          if (infoCard) {
            infoCard.innerHTML = '<div class="info-error">ä¿¡æ¯åŠ è½½å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•</div>';
          }
        }
      }, 500);
    }

    // ç¼–è¾‘æŒ‰é’®é€»è¾‘
    function setupEditButton() {
      const editInfoBtn = document.getElementById('editInfoBtn');
      if (editInfoBtn) {
        editInfoBtn.addEventListener('click', function() {
          const userID = getCookie('user');
          const userDataStr = getCookie('userData');
          if (userID && userDataStr) {
            window.location.href = `edit.html?userData=${encodeURIComponent(userDataStr)}&userID=${userID}`;
          } else {
            showMessage('è·å–ç”¨æˆ·æ•°æ®å¤±è´¥ï¼Œè¯·é‡æ–°ç™»å½•', 'error');
          }
        });
      }
    }

    // åé¦ˆé—®é¢˜åŠŸèƒ½
    function setupFeedbackFunction() {
      const submitBtn = document.getElementById('submitFeedback');
      const cancelBtn = document.getElementById('cancelFeedback');
      const problemField = document.getElementById('problemField');
      const expectedValue = document.getElementById('expectedValue');
      
      if (submitBtn && cancelBtn && problemField && expectedValue) {
        submitBtn.addEventListener('click', function() {
          const problem = problemField.value.trim();
          if (!problem) {
            alert('è¯·è¾“å…¥å­˜åœ¨é—®é¢˜çš„æ•°æ®é¡¹');
            return;
          }
          
          const expected = expectedValue.value.trim() || 'æœªæä¾›';
          const feedbackText = `æˆ‘çš„ï¼ˆ${problem}ï¼‰æ•°æ®å­˜åœ¨é—®é¢˜ï¼ŒåŸæ•°æ®åº”è¯¥æ˜¯ï¼ˆ${expected}ï¼‰ï¼Œè¯·å°½å¿«è§£å†³ã€‚`;
          
          if (confirm('ç¡®è®¤æäº¤åé¦ˆï¼Ÿæäº¤åå°†å¤åˆ¶åé¦ˆå†…å®¹å¹¶å°è¯•æ‰“å¼€QQ')) {
            navigator.clipboard.writeText(feedbackText).then(() => {
              const contactQQ = '458299675';
              window.location.href = `tencent://message/?Menu=yes&Uin=${contactQQ}`;
              alert('åé¦ˆå†…å®¹å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼Œè¯·åœ¨QQä¸ªäººå¯¹è¯æ¡†ä¸­ç²˜è´´åé¦ˆ');
            }).catch(err => {
              console.error('å¤åˆ¶å¤±è´¥:', err);
              alert('å¤åˆ¶å†…å®¹å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ï¼š\n' + feedbackText);
            });
          }
        });
        
        cancelBtn.addEventListener('click', function() {
          problemField.value = '';
          expectedValue.value = '';
        });
      }
    }

    // å¯¼èˆªå’Œæ»‘åŠ¨åŠŸèƒ½
    function setupNavigation() {
      const sections = document.querySelectorAll('.content-section');
      const sidebarLinks = document.querySelectorAll('.sidebar-link');
      const sidebarItems = document.querySelectorAll('.sidebar-item');
      const hamburgerMenu = document.getElementById('hamburgerMenu');
      const sidebar = document.getElementById('sidebar');
      
      let currentIndex = 0;
      let startY = 0;
      let isDragging = false;
      let dragDistance = 0;
      let dragStartTime = 0;

      function syncSidebar() {
        sidebarLinks.forEach((link, index) => {
          link.classList.remove('active');
          sidebarItems[index].classList.remove('expanded');
          if (index === currentIndex) {
            link.classList.add('active');
            sidebarItems[index].classList.add('expanded');
          }
        });
      }

      function switchContent(index) {
        currentIndex = index;
        sections.forEach((sec, i) => {
          sec.style.transform = `translateY(${(i - currentIndex) * 100}vh)`;
        });
        syncSidebar();
      }

      if (sidebarLinks.length > 0) {
        sidebarLinks.forEach((link, index) => {
          link.addEventListener('click', () => {
            switchContent(index);
            if (window.innerWidth <= 768) {
              toggleSidebar();
            }
          });
        });
      }

      function toggleSidebar() {
        if (hamburgerMenu && sidebar) {
          hamburgerMenu.classList.toggle('active');
          sidebar.classList.toggle('active');
          if (sidebar.classList.contains('active')) {
            createOverlay();
          } else {
            removeOverlay();
          }
        }
      }
      
      function createOverlay() {
        const overlay = document.createElement('div');
        overlay.id = 'sidebar-overlay';
        overlay.style.position = 'fixed';
        overlay.style.top = '70px';
        overlay.style.left = '0';
        overlay.style.width = '100%';
        overlay.style.height = 'calc(100vh - 70px)';
        overlay.style.backgroundColor = 'rgba(0, 0, 0, 0.5)';
        overlay.style.zIndex = '996';
        overlay.addEventListener('click', toggleSidebar);
        document.body.appendChild(overlay);
      }
      
      function removeOverlay() {
        const overlay = document.getElementById('sidebar-overlay');
        if (overlay) {
          document.body.removeChild(overlay);
        }
      }
      
      if (hamburgerMenu) {
        hamburgerMenu.addEventListener('click', toggleSidebar);
      }

      function onDragStart(e) {
        if (e.type === 'touchstart') {
          startY = e.touches[0].clientY;
        } else {
          startY = e.clientY;
        }
        isDragging = true;
        dragDistance = 0;
        dragStartTime = Date.now();
        sections.forEach(sec => sec.style.transition = 'none');
      }

      function onDragMove(e) {
        if (!isDragging) return;
        let currentY = 0;
        if (e.type === 'touchmove') {
          currentY = e.touches[0].clientY;
        } else {
          currentY = e.clientY;
        }
        dragDistance = currentY - startY;
        sections.forEach((sec, index) => {
          const targetY = (index - currentIndex) * 100 + (dragDistance * 0.2); 
          sec.style.transform = `translateY(${targetY}vh)`;
        });
      }

      function onDragEnd() {
        if (!isDragging) return;
        isDragging = false;
        sections.forEach(sec => sec.style.transition = 'transform 0.8s cubic-bezier(0.25, 0.8, 0.25, 1)');
        const threshold = window.innerHeight * 0.4;
        const dragTime = Date.now() - dragStartTime;
        const speed = Math.abs(dragDistance) / dragTime;

        if (dragDistance < 0) {
          if (Math.abs(dragDistance) > threshold || speed > 0.7) {
            switchContent(Math.min(currentIndex + 1, sections.length - 1));
          } else {
            switchContent(currentIndex);
          }
        } else {
          if (dragDistance > threshold || speed > 0.7) {
            switchContent(Math.max(currentIndex - 1, 0));
          } else {
            switchContent(currentIndex);
          }
        }
      }

      const content = document.querySelector('.content');
      if (content) {
        content.addEventListener('touchstart', onDragStart);
        content.addEventListener('touchmove', onDragMove);
        content.addEventListener('touchend', onDragEnd);
        content.addEventListener('mousedown', onDragStart);
        content.addEventListener('mousemove', onDragMove);
        content.addEventListener('mouseup', onDragEnd);
        content.addEventListener('mouseleave', onDragEnd);
        
        content.addEventListener('wheel', (e) => {
          e.preventDefault();
          if (e.deltaY > 0) {
            switchContent(Math.min(currentIndex + 1, sections.length - 1));
          } else {
            switchContent(Math.max(currentIndex - 1, 0));
          }
        });
      }

      syncSidebar();
    }

    // ======================
    // è®¤è¯é“­ç‰Œå®Œæ•´åŠŸèƒ½ï¼ˆä¿®å¤ç‰ˆï¼‰
    // ======================
    let currentCategory = '';
    let originalOverflow = '';
    let badgeModalClickX = 0;
    let badgeModalClickY = 0;

    // å¤§åˆ†ç±»é…ç½®
    const CATEGORIES = [
      {
        key: 'ç‰¹æ®Šè®¤è¯æˆå°±',
        fileName: 'è®¤è¯é“­ç‰Œ_ç‰¹æ®Šè®¤è¯æˆå°±.png',
        rawUrl: 'https://raw.githubusercontent.com/godlive-web/godlive-web.github.io/8fc4e2c2ad5666dd64924a3262a5c9ae81e65a18/authentication/%E8%AE%A4%E8%AF%81%E9%93%AD%E7%89%8C_%E7%89%B9%E6%AE%8A%E8%AE%A4%E8%AF%81%E6%88%90%E5%B0%B1.png'
      },
      {
        key: 'ä¸ªäººè®¤è¯ä¿¡æ¯',
        fileName: 'è®¤è¯é“­ç‰Œ_ä¸ªäººè®¤è¯ä¿¡æ¯.png',
        rawUrl: 'https://raw.githubusercontent.com/godlive-web/godlive-web.github.io/8fc4e2c2ad5666dd64924a3262a5c9ae81e65a18/authentication/%E8%AE%A4%E8%AF%81%E9%93%AD%E7%89%8C_%E4%B8%AA%E4%BA%BA%E8%AE%A4%E8%AF%81%E4%BF%A1%E6%81%AF.png'
      },
      {
        key: '2025å¹´åº¦è®¤è¯æˆå°±',
        fileName: 'è®¤è¯é“­ç‰Œ_2025å¹´åº¦è®¤è¯æˆå°±.png',
        rawUrl: 'https://raw.githubusercontent.com/godlive-web/godlive-web.github.io/8fc4e2c2ad5666dd64924a3262a5c9ae81e65a18/authentication/%E8%AE%A4%E8%AF%81%E9%93%AD%E7%89%8C_2025%E5%B9%B4%E5%BA%A6%E8%AE%A4%E8%AF%81%E6%88%90%E5%B0%B1.png'
      }
    ];

    // åˆå§‹åŒ–è®¤è¯é“­ç‰ŒåŠŸèƒ½
    function initAuthBadgeFeature() {
      renderCategoryList();
      bindCategoryModalEvents();
      bindBadgeModalEvents();
      hijackSidebarNavigation();
      console.log('âœ… è®¤è¯é“­ç‰ŒåŠŸèƒ½åˆå§‹åŒ–å®Œæˆ');
    }

    // æ¸²æŸ“å¤§åˆ†ç±»åˆ—è¡¨
    function renderCategoryList() {
      const categoryList = document.getElementById('categoryList');
      if (!categoryList) return;
      
      categoryList.innerHTML = '';
      CATEGORIES.forEach(category => {
        const card = document.createElement('div');
        card.style.cssText = 'flex: 1 1 calc(50% - 7.5px); min-width: 150px; max-width: calc(25% - 11.25px); cursor: pointer; transition: all 0.3s ease; border-radius: 8px; overflow: hidden;';
        card.onmouseover = function() { this.style.transform = 'scale(1.03)'; this.style.boxShadow = 'var(--shadow)'; };
        card.onmouseout = function() { this.style.transform = 'scale(1)'; this.style.boxShadow = 'none'; };
        
        card.innerHTML = `
          <img src="${category.rawUrl}" alt="${category.key}" style="width: 100%; aspect-ratio: 16/9; object-fit: cover; border-radius: 8px;" onerror="this.src='https://raw.githubusercontent.com/godlive-web/godlive-web.github.io/refs/heads/file/%E7%A5%9E%E7%95%8C%E5%AE%98%E7%BD%91icon_20240814_181538_0000.png'">
        `;
        
        card.addEventListener('click', function(e) {
          openCategoryModal(category.key);
        });
        
        categoryList.appendChild(card);
      });
    }

    // ç»‘å®šåˆ†ç±»è¯¦æƒ…å¼¹çª—äº‹ä»¶
    function bindCategoryModalEvents() {
      const overlay = document.getElementById('categoryModalOverlay');
      const modal = document.getElementById('categoryModal');
      const closeBtn = document.getElementById('closeCategoryModalBtn');
      
      if (!overlay || !modal || !closeBtn) return;
      
      overlay.addEventListener('click', closeCategoryModal);
      closeBtn.addEventListener('click', closeCategoryModal);
      adjustModalForDesktop();
      window.addEventListener('resize', adjustModalForDesktop);
    }

    // ç”µè„‘ç«¯é€‚é…ï¼šå¼¹çª—ä¸é®ç›–å·¦ä¾§æ±‰å ¡èœå•
    function adjustModalForDesktop() {
      const modal = document.getElementById('categoryModal');
      const content = document.getElementById('categoryModalContent');
      if (!modal || !content) return;
      
      if (window.innerWidth > 768) {
        const sidebarWidth = getComputedStyle(document.documentElement).getPropertyValue('--sidebar-width') || '260px';
        modal.style.left = sidebarWidth;
        modal.style.width = `calc(100% - ${sidebarWidth})`;
        content.style.paddingLeft = '20px';
      } else {
        modal.style.left = '0';
        modal.style.width = '100%';
        content.style.paddingLeft = '15px';
      }
    }

    // æ‰“å¼€åˆ†ç±»è¯¦æƒ…å¼¹çª—
    function openCategoryModal(categoryKey) {
      currentCategory = categoryKey;
      const overlay = document.getElementById('categoryModalOverlay');
      const modal = document.getElementById('categoryModal');
      const title = document.getElementById('categoryModalTitle');
      const badgeList = document.getElementById('badgeListInModal');
      const badgeEmpty = document.getElementById('badgeEmptyInModal');
      
      if (!overlay || !modal || !title) return;
      
      title.textContent = categoryKey;
      disableMainScroll();
      
      overlay.style.display = 'block';
      modal.style.display = 'block';
      requestAnimationFrame(() => {
        overlay.style.opacity = '1';
        modal.style.transform = 'translateY(0)';
      });
      
      loadBadgesInCategory(categoryKey, badgeList, badgeEmpty);
    }

    // å…³é—­åˆ†ç±»è¯¦æƒ…å¼¹çª—
    function closeCategoryModal() {
      const overlay = document.getElementById('categoryModalOverlay');
      const modal = document.getElementById('categoryModal');
      
      if (!overlay || !modal) return;
      
      overlay.style.opacity = '0';
      modal.style.transform = 'translateY(100%)';
      
      setTimeout(() => {
        overlay.style.display = 'none';
        modal.style.display = 'none';
        enableMainScroll();
      }, 300);
      
      currentCategory = '';
    }

    // ç¦ç”¨ä¸»é¡µé¢æ»šåŠ¨
    function disableMainScroll() {
      const content = document.querySelector('.content');
      const sidebar = document.getElementById('sidebar');
      if (content) {
        originalOverflow = content.style.overflow;
        content.style.overflow = 'hidden';
      }
      if (sidebar) {
        sidebar.style.overflow = 'hidden';
      }
      document.body.style.overflow = 'hidden';
    }

    // æ¢å¤ä¸»é¡µé¢æ»šåŠ¨
    function enableMainScroll() {
      const content = document.querySelector('.content');
      const sidebar = document.getElementById('sidebar');
      if (content) {
        content.style.overflow = originalOverflow || 'hidden';
      }
      if (sidebar) {
        sidebar.style.overflow = 'auto';
      }
      document.body.style.overflow = 'hidden';
    }

    // åŠ«æŒå·¦ä¾§å¯¼èˆªï¼šç‚¹å‡»æ—¶å…³é—­å¼¹çª—
    function hijackSidebarNavigation() {
      const sidebarLinks = document.querySelectorAll('.sidebar-link');
      sidebarLinks.forEach(link => {
        link.addEventListener('click', function() {
          if (currentCategory) {
            closeCategoryModal();
          }
        });
      });
    }

  // ã€æ ¸å¿ƒä¿®å¤ã€‘åŠ è½½åˆ†ç±»ä¸‹çš„é“­ç‰Œï¼ŒåŒæ—¶è·å–å›¾ç‰‡å’Œä»‹ç»
  async function loadBadgesInCategory(categoryKey, badgeListEl, badgeEmptyEl) {
    if (!badgeListEl || !badgeEmptyEl) return;
  
    badgeListEl.innerHTML = '';
    badgeEmptyEl.style.display = 'none';
    badgeListEl.style.display = 'flex';
  
    try {
      // ä¼˜å…ˆç”¨å…¨å±€æœ€æ–°æ•°æ®ï¼Œä¸ç”¨Cookieç¼“å­˜
      const userData = globalLatestUserData;
      console.log('ğŸ” åŠ è½½é“­ç‰Œä½¿ç”¨çš„ç”¨æˆ·æ•°æ®ï¼š', userData);
      if (!userData) {
        badgeEmptyEl.style.display = 'block';
        badgeListEl.style.display = 'none';
        return;
      }
    
      // ä¼˜å…ˆè¯»å–è®¤è¯æˆå°±å­—æ®µ
      const achievementsStr = userData['è®¤è¯æˆå°±'] || userData['achievements'] || userData['æˆå°±'] || '';
      console.log('ğŸ” è¯»å–åˆ°çš„è®¤è¯æˆå°±å­—æ®µï¼š', achievementsStr);
    
      const categoryAchievements = parseAchievementsByCategory(achievementsStr, categoryKey);
      console.log('ğŸ” è§£æåˆ°çš„å½“å‰åˆ†ç±»æˆå°±ï¼š', categoryAchievements);
    
      if (!categoryAchievements || categoryAchievements.length === 0) {
        badgeEmptyEl.style.display = 'block';
        badgeListEl.style.display = 'none';
        document.getElementById('categoryModalContent').style.overflow = 'hidden';
        return;
      }
    
      document.getElementById('categoryModalContent').style.overflow = 'auto';
    
      const badgeList = [];
      for (const achievement of categoryAchievements) {
        try {
          console.log(`ğŸ” æ­£åœ¨è·å–ã€Œ${achievement.name}ã€çš„é“­ç‰Œä¿¡æ¯`);
          // åŒæ—¶è°ƒç”¨ä¸¤ä¸ªæ¥å£
          const [badgeUrlRes, badgeDescRes] = await Promise.all([
            fetch(`${VERCEL_DOMAIN}/api/getAuthBadge?achievement=${encodeURIComponent(achievement.name)}`),
            fetch(`${VERCEL_DOMAIN}/api/getBadgeDesc?achievement=${encodeURIComponent(achievement.name)}`)
          ]);
          const urlData = await badgeUrlRes.json();
          const descData = await badgeDescRes.json();
          console.log(`âœ… ã€Œ${achievement.name}ã€APIè¿”å›ï¼š`, {urlData, descData});
        
          // åªè¦å›¾ç‰‡åœ°å€å­˜åœ¨ï¼Œå°±æ˜¾ç¤ºé“­ç‰Œï¼Œæè¿°ä¼˜å…ˆç”¨æ¥å£è¿”å›çš„ä»‹ç»
          if (urlData.success && urlData.data && urlData.data.outputUrl) {
            badgeList.push({
              name: achievement.name,
              time: achievement.time,
              url: urlData.data.outputUrl,
              desc: descData.success && descData.data && descData.data.description 
                ? descData.data.description 
                : achievement.name // å…œåº•ï¼šå¦‚æœä»‹ç»æ¥å£å¤±è´¥ï¼Œç”¨æˆå°±åç§°
            });
          } else {
            console.warn(`âš ï¸ ã€Œ${achievement.name}ã€æ¥å£è¿”å›å¤±è´¥ï¼Œè·³è¿‡è¯¥é“­ç‰Œ`);
          }
        } catch (apiErr) {
          console.error(`âŒ è·å–æˆå°±ã€Œ${achievement.name}ã€ä¿¡æ¯å¤±è´¥ï¼š`, apiErr);
        }
      }
    
      if (badgeList.length === 0) {
        badgeEmptyEl.style.display = 'block';
        badgeListEl.style.display = 'none';
        document.getElementById('categoryModalContent').style.overflow = 'hidden';
        return;
      }
    
     renderBadgeListInModal(badgeList, badgeListEl);
    
    } catch (error) {
      console.error('âŒ åŠ è½½åˆ†ç±»é“­ç‰Œå¤±è´¥ï¼š', error);
      badgeEmptyEl.style.display = 'block';
      badgeListEl.style.display = 'none';
      document.getElementById('categoryModalContent').style.overflow = 'hidden';
    }
  }

    // è§£ææˆå°±å­—ç¬¦ä¸²ï¼ˆé€‚é…ä¸­æ–‡å†’å·ï¼šå’Œä¸­æ–‡åˆ†å·ï¼›ï¼‰
    function parseAchievementsByCategory(achievementsStr, targetCategory) {
      if (!achievementsStr) return [];
      
      const results = [];
      // ç”¨ã€ä¸­æ–‡åˆ†å·ï¼›ã€‘åˆ†å‰²ä¸åŒåˆ†ç±»
      const categoryParts = achievementsStr.split('ï¼›');
      console.log('ğŸ” åˆ†å‰²åçš„åˆ†ç±»åˆ—è¡¨ï¼š', categoryParts);
      
      for (const part of categoryParts) {
        // ç”¨ã€ä¸­æ–‡å†’å·ï¼šã€‘åˆ†å‰²åˆ†ç±»åå’Œæˆå°±åˆ—è¡¨
        const [categoryName, achievementsPart] = part.split('ï¼š');
        console.log('ğŸ” åˆ†å‰²åˆ†ç±»åå’Œæˆå°±ï¼š', {categoryName, achievementsPart});
        
        if (!categoryName || !achievementsPart) continue;
        
        if (categoryName.trim() === targetCategory) {
          const achievementItems = achievementsPart.split('ã€');
          for (const item of achievementItems) {
            if (!item.trim()) continue;
            const match = item.match(/^(.+?)ï¼ˆ(.+?)ï¼‰$/);
            if (match) {
              results.push({
                name: match[1].trim(),
                time: match[2].trim()
              });
            } else {
              results.push({
                name: item.trim(),
                time: 'æœªçŸ¥'
              });
            }
          }
          break;
        }
      }
      
      return results;
    }

    // æ¸²æŸ“å¼¹çª—å†…çš„é“­ç‰Œåˆ—è¡¨
    function renderBadgeListInModal(badgeList, badgeListEl) {
      badgeListEl.innerHTML = '';
      
      badgeList.forEach(badge => {
        const card = document.createElement('div');
        card.style.cssText = 'flex: 1 1 calc(50% - 7.5px); min-width: 150px; max-width: calc(25% - 11.25px); cursor: pointer; transition: all 0.3s ease; border-radius: 8px; overflow: hidden; background: var(--card-bg); border: 1px solid var(--border-color); padding: 10px;';
        card.onmouseover = function() { this.style.transform = 'scale(1.03)'; this.style.boxShadow = 'var(--shadow)'; };
        card.onmouseout = function() { this.style.transform = 'scale(1)'; this.style.boxShadow = 'none'; };
        
        card.innerHTML = `
          <img src="${badge.url}" alt="${badge.name}" style="width: 100%; aspect-ratio: 16/9; object-fit: cover; border-radius: 8px; margin-bottom: 8px;" onerror="this.src='https://raw.githubusercontent.com/godlive-web/godlive-web.github.io/refs/heads/file/%E7%A5%9E%E7%95%8C%E5%AE%98%E7%BD%91icon_20240814_181538_0000.png'">
          <div style="font-weight: bold; color: var(--text-primary); margin-bottom: 3px; font-size: 14px; text-align: center;">${badge.name}</div>
          <div style="font-size: 12px; color: var(--text-secondary); text-align: center;">è·å¾—æ—¶é—´ï¼š${badge.time}</div>
        `;
        
        card.addEventListener('click', function(e) {
          badgeModalClickX = e.clientX;
          badgeModalClickY = e.clientY;
          openBadgeModal(badge);
        });
        
        badgeListEl.appendChild(card);
      });
      console.log('âœ… é“­ç‰Œåˆ—è¡¨æ¸²æŸ“å®Œæˆï¼Œå…±', badgeList.length, 'ä¸ª');
    }

    // ç»‘å®šå•ä¸ªé“­ç‰Œå¼¹çª—äº‹ä»¶
    function bindBadgeModalEvents() {
      const overlay = document.getElementById('badgeModalOverlay');
      const modal = document.getElementById('badgeModal');
      const closeBtn = document.getElementById('closeBadgeModalBtn');
      
      if (!overlay || !modal || !closeBtn) return;
      
      overlay.addEventListener('click', closeBadgeModal);
      closeBtn.addEventListener('click', closeBadgeModal);
    }

    // æ‰“å¼€å•ä¸ªé“­ç‰Œè¯¦æƒ…å¼¹çª—
    function openBadgeModal(badge) {
      const overlay = document.getElementById('badgeModalOverlay');
      const modal = document.getElementById('badgeModal');
      const title = document.getElementById('badgeModalTitle');
      const img = document.getElementById('badgeModalImg');
      const time = document.getElementById('badgeModalTime');
      const desc = document.getElementById('badgeModalDesc');
      
      if (!overlay || !modal || !title) return;
      
      title.textContent = badge.name;
      img.src = badge.url;
      img.onerror = function() {
        this.src = 'https://raw.githubusercontent.com/godlive-web/godlive-web.github.io/refs/heads/file/%E7%A5%9E%E7%95%8C%E5%AE%98%E7%BD%91icon_20240814_181538_0000.png';
      };
      time.textContent = `è·å¾—æ—¶é—´ï¼š${badge.time}`;
      desc.textContent = badge.desc;
      
      overlay.style.display = 'block';
      modal.style.display = 'block';
      
      requestAnimationFrame(() => {
        overlay.style.opacity = '1';
        modal.style.opacity = '1';
        modal.style.transform = 'translate(-50%, -50%) scale(1)';
      });
    }

    // å…³é—­å•ä¸ªé“­ç‰Œè¯¦æƒ…å¼¹çª—
    function closeBadgeModal() {
      const overlay = document.getElementById('badgeModalOverlay');
      const modal = document.getElementById('badgeModal');
      
      if (!overlay || !modal) return;
      
      overlay.style.opacity = '0';
      modal.style.opacity = '0';
      modal.style.transform = 'translate(-50%, -50%) scale(0.8)';
      
      setTimeout(() => {
        overlay.style.display = 'none';
        modal.style.display = 'none';
      }, 300);
    }

    // é¡µé¢åŠ è½½æ—¶ç»Ÿä¸€åˆå§‹åŒ–
    document.addEventListener('DOMContentLoaded', async function() {
      const isLogin = checkLoginStatus();
      if (!isLogin) return;
      
      const latestData = await fetchLatestUserInfo();
      loadBasicInfo(latestData);
      setupFeedbackFunction();
      setupNavigation();
      setupEditButton();
      // ç¡®ä¿ç”¨æˆ·æ•°æ®åŠ è½½å®Œæˆåï¼Œå†åˆå§‹åŒ–é“­ç‰ŒåŠŸèƒ½
      initAuthBadgeFeature();
    });
  </script>
</body>
</html>
